(function(){var e=Easemob.im,b=e.Connection,c=e.EmMessage,a=function(){},f=location.protocol==="https:";e.version="2.0shim";e.Helper.download=e.Helper.downloadFn;e.EMOTIONS={path:"/Contents/Hplus/js/plugins/layer/layim/faces/",map:{"[):]":"ee_1.png","[:D]":"ee_2.png","[;)]":"ee_3.png","[:-o]":"ee_4.png","[:p]":"ee_5.png","[(H)]":"ee_6.png","[:@]":"ee_7.png","[:s]":"ee_8.png","[:$]":"ee_9.png","[:(]":"ee_10.png","[:'(]":"ee_11.png","[:|]":"ee_12.png","[(a)]":"ee_13.png","[8o|]":"ee_14.png","[8-|]":"ee_15.png","[+o(]":"ee_16.png","[<o)]":"ee_17.png","[|-)]":"ee_18.png","[*-)]":"ee_19.png","[:-#]":"ee_20.png","[:-*]":"ee_21.png","[^o)]":"ee_22.png","[8-)]":"ee_23.png","[(|)]":"ee_24.png","[(u)]":"ee_25.png","[(S)]":"ee_26.png","[(*)]":"ee_27.png","[(#)]":"ee_28.png","[(R)]":"ee_29.png","[({)]":"ee_30.png","[(})]":"ee_31.png","[(k)]":"ee_32.png","[(F)]":"ee_33.png","[(W)]":"ee_34.png","[(D)]":"ee_35.png"}};e.Helper.EmotionPicData=(function(){var g={};for(var h in e.EMOTIONS.map){if(e.EMOTIONS.map.hasOwnProperty(h)){g[h]=e.EMOTIONS.map[h]}}return g}());e.Helper.getIEVersion=(function(){var h=navigator.userAgent,i,g={"4":8,"5":9,"6":10,"7":11};i=h.match(/MSIE (\d+)/i);if(i&&i[1]){return +i[1]}i=h.match(/Trident\/(\d+)/i);if(i&&i[1]){return g[i[1]]||null}return null}());c.txt=function(g){this.id=g;this.type="txt";this.brief="";this.body={}};c.txt.prototype.set=function(g){this.value=g.msg;if(this.value){this.brief=this.value.replace(/\n/mg,"");this.brief=(this.brief.length>15?this.brief.slice(0,15)+"...":this.brief)}this.body={id:this.id,to:g.to,msg:this.value,type:this.type,roomType:g.roomType,ext:g.ext||{},success:g.success,fail:g.fail}};c.cmd=function(g){this.id=g;this.type="cmd";this.body={}};c.cmd.prototype.set=function(g){this.value="";this.body={to:g.to,action:g.action,msg:this.value,type:this.type,roomType:g.roomType,ext:g.ext||{}}};c.location=function(g){this.id=g;this.type="loc";this.body={}};c.location.prototype.set=function(g){this.body={to:g.to,type:this.type,roomType:g.roomType,addr:g.addr,lat:g.lat,lng:g.lng,ext:g.ext||{}}};c.img=function(g){this.id=g;this.type="img";this.brief="图片";this.body={}};c.img.prototype.set=function(g){g.file=g.file||e.Utils.getFileUrl(g.fileInputId);this.value=g.file;this.body={id:this.id,file:this.value,apiUrl:g.apiUrl,to:g.to,type:this.type,ext:g.ext||{},roomType:g.roomType,onFileUploadError:g.onFileUploadError,onFileUploadComplete:g.onFileUploadComplete,success:g.success,fail:g.fail,flashUpload:g.flashUpload}};c.audio=function(g){this.id=g;this.type="audio";this.brief="音频";this.body={}};c.audio.prototype.set=function(g){g.file=g.file||e.Utils.getFileUrl(g.fileInputId);this.value=g.file;this.filename=g.filename||this.value.filename||"音频";this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:g.apiUrl,to:g.to,type:this.type,ext:g.ext||{},roomType:g.roomType,onFileUploadError:g.onFileUploadError,onFileUploadComplete:g.onFileUploadComplete,success:g.success,fail:g.fail,flashUpload:g.flashUpload}};c.file=function(g){this.id=g;this.type="file";this.brief="文件";this.body={}};c.file.prototype.set=function(g){g.file=g.file||e.Utils.getFileUrl(g.fileInputId);this.value=g.file;this.filename=g.filename||this.value.filename||"文件";this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:g.apiUrl,to:g.to,type:this.type,ext:g.ext||{},roomType:g.roomType,onFileUploadError:g.onFileUploadError,onFileUploadComplete:g.onFileUploadComplete,success:g.success,fail:g.fail,flashUpload:g.flashUpload}};b.prototype.init=function(g){for(var h in g){if(g.hasOwnProperty(h)){this[h]=g[h]}}this.listen(g)};var d=function(h,g){var i=new c(h);g.id&&(i.id=g.id);i.set(g);g.type==="groupchat"&&i.setGroup(g.type);this.send(i.body)};b.prototype.sendTextMessage=function(g){d.call(this,"txt",g)};b.prototype.sendPicture=function(g){d.call(this,"img",g)};b.prototype.sendAudio=function(g){d.call(this,"audio",g)};b.prototype.sendFile=function(g){d.call(this,"file",g)};b.prototype.sendLocationMessage=function(g){d.call(this,"location",g)};b.prototype.sendCmdMessage=function(g){d.call(this,"cmd",g)};b.prototype.sendPictureMessage=a;b.prototype.sendAudioMessage=a;b.prototype.sendFileMessage=a;e.Helper.innerBase64=(function(){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var h={encode:function(l){var j="";var s,q,o;var r,p,n,m;var k=0;do{s=l.charCodeAt(k++);q=l.charCodeAt(k++);o=l.charCodeAt(k++);r=s>>2;p=((s&3)<<4)|(q>>4);n=((q&15)<<2)|(o>>6);m=o&63;if(isNaN(q)){n=m=64}else{if(isNaN(o)){m=64}}j=j+g.charAt(r)+g.charAt(p)+g.charAt(n)+g.charAt(m)}while(k<l.length);return j},byteEncode:function(s){var j="";var r,p,n;var q,o,m,l;var k=0;do{r=s[k++];p=s[k++];n=s[k++];q=r>>2;o=((r&3)<<4)|(p>>4);m=((p&15)<<2)|(n>>6);l=n&63;if(isNaN(p)){m=l=64}else{if(isNaN(n)){l=64}}j=j+g.charAt(q)+g.charAt(o)+g.charAt(m)+g.charAt(l)}while(k<s.length);return j},decode:function(l){var j="";var s,q,o;var r,p,n,m;var k=0;l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{r=g.indexOf(l.charAt(k++));p=g.indexOf(l.charAt(k++));n=g.indexOf(l.charAt(k++));m=g.indexOf(l.charAt(k++));s=(r<<2)|(p>>4);q=((p&15)<<4)|(n>>2);o=((n&3)<<6)|m;j=j+String.fromCharCode(s);if(n!=64){j=j+String.fromCharCode(q)}if(m!=64){j=j+String.fromCharCode(o)}}while(k<l.length);return j}};return h})()}());